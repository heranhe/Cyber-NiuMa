# Vercel KV é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®ä½¿ç”¨ **Vercel KV**ï¼ˆåŸºäº Redisï¼‰å­˜å‚¨ç”¨æˆ·æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š
- ç”¨æˆ·å¤´åƒå’Œç”¨æˆ·å
- ç”¨æˆ·é…ç½®çš„ AI èƒ½åŠ›åˆ—è¡¨

## ğŸš€ å¿«é€Ÿé…ç½®æ­¥éª¤

### 1. åœ¨ Vercel é¡¹ç›®ä¸­æ·»åŠ  KV storå­˜å‚¨

1. è®¿é—®ä½ çš„ Vercel é¡¹ç›®ä»ªè¡¨æ¿
2. è¿›å…¥ **Storage** æ ‡ç­¾
3. ç‚¹å‡» **Create Database**
4. é€‰æ‹© **KV** (Redis)
5. è¾“å…¥æ•°æ®åº“åç§°ï¼ˆä¾‹å¦‚ï¼š`ai-labor-market-kv`ï¼‰
6. ç‚¹å‡» **Create**

### 2. ç¯å¢ƒå˜é‡è‡ªåŠ¨é…ç½®

Vercel ä¼šè‡ªåŠ¨ä¸ºä½ çš„é¡¹ç›®æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
```
KV_URL
KV_REST_API_URL
KV_REST_API_TOKEN
KV_REST_API_READ_ONLY_TOKEN
```

æ— éœ€æ‰‹åŠ¨é…ç½®ï¼âœ…

### 3. æœ¬åœ°å¼€å‘é…ç½®ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦åœ¨æœ¬åœ°æµ‹è¯•ï¼Œè¿è¡Œï¼š

```bash
vercel env pull .env.local
```

è¿™ä¼šè‡ªåŠ¨ä¸‹è½½ç¯å¢ƒå˜é‡åˆ°æœ¬åœ° `.env.local` æ–‡ä»¶ã€‚

> âš ï¸ **å®‰å…¨è­¦å‘Š**
> 
> - `.env.local` æ–‡ä»¶åŒ…å«æ•æ„Ÿçš„æ•°æ®åº“å‡­è¯å’Œ API å¯†é’¥
> - **å·²æ·»åŠ åˆ° `.gitignore`ï¼Œç¡®ä¿ä¸ä¼šæäº¤åˆ° Git**
> - åˆ‡å‹¿å°† `.env*` æ–‡ä»¶åˆ†äº«æˆ–ä¸Šä¼ åˆ°å…¬å¼€ä»“åº“

## ğŸ“¦ æ•°æ®ç»“æ„è¯´æ˜

### ç”¨æˆ·æ•°æ®å­˜å‚¨
```
Key: user:{userId}
Type: Hash
Fields:
  - username: ç”¨æˆ·å
  - avatar: å¤´åƒ URL
  - capabilities: JSON å­—ç¬¦ä¸²ï¼ˆæŠ€èƒ½åˆ—è¡¨ï¼‰
```

### AI èƒ½åŠ›å­˜å‚¨
```
Key: capabilities:{userId}
Type: JSON
Value: [
  {
    id: "å”¯ä¸€ID",
    name: "èƒ½åŠ›åç§°",
    icon: "ğŸ¨",
    description: "èƒ½åŠ›æè¿°",
    prompt: "ç³»ç»Ÿæç¤ºè¯"
  }
]
```

## ğŸ”§ API æ¥å£

### 1. è·å–ç”¨æˆ·æ•°æ®
```http
GET /api/user?userId={userId}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "username": "å‘¨æ°ä¼¦",
  "avatar": "https://example.com/avatar.jpg",
  "capabilities": ["èƒ½åŠ›1", "èƒ½åŠ›2"]
}
```

### 2. ä¿å­˜ç”¨æˆ·æ•°æ®
```http
POST /api/user
Content-Type: application/json

{
  "userId": "user123",
  "username": "å‘¨æ°ä¼¦",
  "avatar": "https://...",
  "capabilities": ["è§†è§‰ç¾åŒ–å¤§å¸ˆ", "åˆ›æ„æ–‡æ¡ˆåŠ©æ‰‹"]
}
```

### 3. è·å– AI èƒ½åŠ›åˆ—è¡¨
```http
GET /api/capabilities?userId={userId}
```

### 4. æ·»åŠ /æ›´æ–° AI èƒ½åŠ›
```http
POST /api/capabilities
Content-Type: application/json

{
  "userId": "user123",
  "capability": {
    "id": "cap1",
    "name": "è§†è§‰ç¾åŒ–å¤§å¸ˆ",
    "icon": "ğŸ¨",
    "description": "ä¸“ä¸šå¤„ç†äººåƒå…‰å½±",
    "prompt": "..."
  }
}
```

## ğŸ¨ å‰ç«¯ UI åŠŸèƒ½

### AI åˆ†èº«å®¹å™¨

åœ¨"æˆ‘çš„æŠ€èƒ½"é¡µé¢ï¼Œå½“ç”¨æˆ·ç™»å½•ä¸”é…ç½®äº† AI èƒ½åŠ›åï¼Œä¼šæ˜¾ç¤ºï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [å¤´åƒå›¾ç‰‡]  å‘¨æ°ä¼¦çš„AIåˆ†èº«          â”‚
â”‚                                     â”‚
â”‚  AIåˆ†èº«çš„æŠ€èƒ½ï¼š                      â”‚
â”‚  [è§†è§‰ç¾åŒ–å¤§å¸ˆ] [åˆ›æ„æ–‡æ¡ˆåŠ©æ‰‹]       â”‚
â”‚  [æé€Ÿä»£ç ä¸“å®¶]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹ç‚¹ï¼š**
- âœ… åŠ¨æ€æ˜¾ç¤ºç”¨æˆ·å¤´åƒ
- âœ… ç”¨æˆ·åè‡ªåŠ¨æ‹¼æ¥"çš„AIåˆ†èº«"
- âœ… æŠ€èƒ½æ ‡ç­¾é‡‡ç”¨èƒ¶å›Šæ ·å¼ï¼ˆé»‘è‰²å­—ä½“ï¼Œæµ…ç°èƒŒæ™¯ï¼‰
- âœ… å…¨éƒ¨æŠ€èƒ½æ ‡ç­¾éƒ½ä¼šæ˜¾ç¤ºï¼Œè‡ªåŠ¨æ¢è¡Œ

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šæœ¬åœ°å¼€å‘æŠ¥é”™ "KV_URL is not defined"
**è§£å†³æ–¹æ¡ˆï¼š**
```bash
vercel env pull .env.local
npm run dev
```

### é—®é¢˜2ï¼šéƒ¨ç½²åæ•°æ®æ— æ³•ä¿å­˜
**æ£€æŸ¥æ­¥éª¤ï¼š**
1. ç¡®è®¤ Vercel é¡¹ç›®å·²æ·»åŠ  KV å­˜å‚¨
2. æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦è‡ªåŠ¨æ·»åŠ 
3. é‡æ–°éƒ¨ç½²é¡¹ç›®

### é—®é¢˜3ï¼šVercel KV å·²å¼ƒç”¨è­¦å‘Š
**è¯´æ˜ï¼š** Vercel KV å·²è¿ç§»åˆ° Upstash Redisï¼Œä½†ç°æœ‰é¡¹ç›®ä»å¯ä½¿ç”¨ã€‚æ–°é¡¹ç›®å»ºè®®ä½¿ç”¨ Upstash Redis Integrationã€‚

**è¿ç§»æ–¹æ¡ˆï¼š**
1. è®¿é—® Vercel Marketplace
2. å®‰è£… Upstash Redis Integration
3. ä»£ç æ— éœ€ä¿®æ”¹ï¼ˆAPI å…¼å®¹ï¼‰

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å…è´¹é¢åº¦é™åˆ¶**
   - æ¯æœˆ 3000 æ¬¡è¯·æ±‚ï¼ˆå…è´¹ç‰ˆï¼‰
   - å­˜å‚¨å®¹é‡ï¼š256MB

2. **æ•°æ®æŒä¹…åŒ–**
   - Vercel KV æ•°æ®ä¼šæŒä¹…ä¿å­˜
   - å»ºè®®å®šæœŸå¤‡ä»½é‡è¦æ•°æ®

3. **å®‰å…¨æ€§**
   - API å¯†é’¥è‡ªåŠ¨ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®
   - å»ºè®®æ·»åŠ ç”¨æˆ·è®¤è¯æœºåˆ¶

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Vercel KV å®˜æ–¹æ–‡æ¡£](https://vercel.com/docs/storage/vercel-kv)
- [Upstash Redis æ–‡æ¡£](https://docs.upstash.com/)
- [@vercel/kv NPM åŒ…](https://www.npmjs.com/package/@vercel/kv)

---

**éƒ¨ç½²å®Œæˆåï¼Œæ‚¨çš„ç”¨æˆ·æ•°æ®å°†è‡ªåŠ¨å­˜å‚¨åœ¨ Vercel KV ä¸­ï¼** ğŸ‰

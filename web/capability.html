<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI èƒ½åŠ›ç®¡ç† - Cyber NiuMa</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700;900&display=swap"
    rel="stylesheet" />
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: '#D97706',
            'background-light': '#FDFBF7',
            'background-dark': '#1F1F1F',
            'surface-light': '#FFFFFF',
            'surface-dark': '#2D2D2D',
            'border-light': '#E5E7EB',
            'border-dark': '#404040',
            'text-light': '#1F2937',
            'text-dark': '#F3F4F6',
            'subtext-light': '#6B7280',
            'subtext-dark': '#9CA3AF'
          },
          fontFamily: {
            sans: ['"Noto Sans SC"', 'ui-sans-serif', 'system-ui']
          },
          backgroundImage: {
            'grid-pattern': "linear-gradient(to right, rgba(0,0,0,0.05) 1px, transparent 1px), linear-gradient(to bottom, rgba(0,0,0,0.05) 1px, transparent 1px)"
          }
        }
      }
    };
  </script>
  <style>
    .grid-bg {
      background-size: 40px 40px;
    }

    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    .ability-card.is-active {
      border-color: #D97706;
      background: #FFF7ED;
      box-shadow: 0 8px 18px rgba(217, 119, 6, 0.12);
    }

    /* iOS é£æ ¼æ»‘åŠ¨å¼€å…³ - ä½¿ç”¨é«˜ä¼˜å…ˆçº§é€‰æ‹©å™¨è¦†ç›– Tailwind forms */
    input[type="checkbox"].switch {
      /* å®Œå…¨é‡ç½® checkbox çš„é»˜è®¤å¤–è§‚ */
      appearance: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;

      /* ç§»é™¤ Tailwind forms æ’ä»¶çš„æ ·å¼ */
      border: none !important;
      box-shadow: none !important;
      color: transparent !important;
      padding: 0 !important;

      /* iOS é£æ ¼æ»‘åŠ¨å¼€å…³æ ·å¼ */
      width: 2.8rem !important;
      height: 1.55rem !important;
      border-radius: 9999px !important;
      background-color: #D1D5DB !important;
      background-image: none !important;
      background-size: 0 !important;
      background-position: 0 0 !important;
      position: relative;
      transition: all .2s ease;
      cursor: pointer;
    }

    input[type="checkbox"].switch::before {
      display: none !important;
    }

    input[type="checkbox"].switch::after {
      content: '' !important;
      display: block !important;
      position: absolute;
      width: 1.2rem;
      height: 1.2rem;
      border-radius: 9999px;
      top: 0.175rem;
      left: 0.175rem;
      background-color: white !important;
      background-image: none !important;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      transition: transform .2s ease;
    }

    input[type="checkbox"].switch:checked {
      background-color: #16A34A !important;
      background-image: none !important;
      border-color: #16A34A !important;
    }

    input[type="checkbox"].switch:checked::after {
      transform: translateX(1.25rem);
    }

    /* ç§»é™¤ç„¦ç‚¹æ—¶çš„è¾¹æ¡†æ ·å¼ */
    input[type="checkbox"].switch:focus {
      outline: none !important;
      box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.1) !important;
      --tw-ring-shadow: none !important;
    }

    .toast {
      position: fixed;
      left: 50%;
      bottom: 24px;
      transform: translate(-50%, 120%);
      padding: 10px 20px;
      border-radius: 10px;
      background: #111827;
      color: #fff;
      font-size: 13px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      opacity: 0;
      transition: all .25s ease;
      z-index: 999;
    }

    .toast.show {
      transform: translate(-50%, 0);
      opacity: 1;
    }

    /* é£æ ¼å¡ç‰‡åŒºåŸŸ */
    .style-scroll {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding: 4px 0;
      scroll-behavior: smooth;
    }

    .style-scroll::-webkit-scrollbar {
      height: 4px;
    }

    .style-scroll::-webkit-scrollbar-thumb {
      background: #D1D5DB;
      border-radius: 2px;
    }

    .style-card {
      flex-shrink: 0;
      width: 100px;
      cursor: pointer;
      border-radius: 16px;
      border: 2px solid transparent;
      background: #F9FAFB;
      transition: all .2s ease;
      overflow: hidden;
      position: relative;
    }

    .style-card:hover {
      border-color: #D97706;
      box-shadow: 0 4px 12px rgba(217, 119, 6, 0.15);
      transform: translateY(-2px);
    }

    .style-card.is-selected {
      border-color: #D97706;
      background: #FFF7ED;
      box-shadow: 0 4px 12px rgba(217, 119, 6, 0.2);
    }

    .style-card-img {
      width: 100%;
      height: 72px;
      object-fit: cover;
      background: linear-gradient(135deg, #F3F4F6, #E5E7EB);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #9CA3AF;
      font-size: 24px;
    }

    .style-card-img img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .style-card-name {
      padding: 6px 8px;
      font-size: 11px;
      font-weight: 700;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: #374151;
    }

    .style-card-add {
      flex-shrink: 0;
      width: 100px;
      height: 100%;
      min-height: 98px;
      cursor: pointer;
      border-radius: 16px;
      border: 2px dashed #D1D5DB;
      background: transparent;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      color: #9CA3AF;
      font-size: 11px;
      font-weight: 600;
      transition: all .2s ease;
    }

    .style-card-add:hover {
      border-color: #D97706;
      color: #D97706;
      background: #FFFBEB;
    }

    .style-card-add svg {
      width: 20px;
      height: 20px;
    }

    .style-card-delete {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      cursor: pointer;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      line-height: 1;
      padding: 0;
    }

    .style-card:hover .style-card-delete {
      display: flex;
    }
  </style>
</head>

<body class="bg-background-light text-text-light font-sans h-screen overflow-hidden">
  <div class="fixed inset-0 pointer-events-none z-0 bg-grid-pattern grid-bg opacity-60"></div>

  <div class="relative z-10 h-screen flex flex-col">
    <nav class="px-4 md:px-6 py-3 border-b border-border-light bg-background-light/90 backdrop-blur-md shrink-0">
      <div class="max-w-[1600px] mx-auto flex items-center justify-between gap-3">
        <a href="/" class="flex items-center gap-3 min-w-0">
          <img src="/logo.png?v=1770455352" alt="logo" class="w-9 h-9 rounded-lg shadow-sm" />
          <span class="text-xl font-black tracking-tight text-gray-900 truncate">Cyber NiuMa</span>
        </a>

        <div class="hidden md:flex items-center gap-6 text-sm">
          <a class="font-bold text-primary border-b-2 border-primary pb-1" href="/capability.html">AI èƒ½åŠ›ç®¡ç†</a>
          <a class="font-medium text-subtext-light hover:text-primary transition-colors" href="/">ä»»åŠ¡å¹¿åœº</a>
        </div>

        <div class="flex items-center gap-2">
          <span id="user-chip"
            class="hidden text-xs px-2.5 py-1 rounded-full bg-gray-100 text-gray-700 font-medium"></span>
          <button id="login-btn"
            class="px-4 py-2 text-xs md:text-sm font-bold bg-primary text-white rounded-lg hover:bg-amber-700 transition-colors">
            ç™»å½• SecondMe
          </button>
          <button id="logout-btn"
            class="hidden px-3 py-2 text-xs md:text-sm font-bold bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
            é€€å‡º
          </button>
        </div>
      </div>
    </nav>

    <main class="flex-1 overflow-hidden">
      <div class="max-w-[1600px] mx-auto h-full p-3 md:p-5">
        <div class="h-full grid grid-cols-1 lg:grid-cols-[360px_minmax(0,1fr)] gap-4">
          <aside class="bg-white/70 backdrop-blur-sm border border-gray-100 rounded-3xl flex flex-col min-h-0">
            <div class="p-4 border-b border-border-light space-y-3">
              <div class="flex items-center justify-between">
                <h2 class="text-sm font-black tracking-wide uppercase">æˆ‘çš„ AI èƒ½åŠ›</h2>
                <span id="ability-count"
                  class="text-[11px] font-bold px-2 py-0.5 rounded bg-gray-100 text-gray-600">0</span>
              </div>
              <button id="add-ability-btn"
                class="w-full inline-flex items-center justify-center gap-2 py-2.5 rounded-xl bg-black text-white text-sm font-bold hover:opacity-90 transition-opacity">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                  <path fill-rule="evenodd"
                    d="M12 2.25a.75.75 0 0 1 .75.75v8.25H21a.75.75 0 0 1 0 1.5h-8.25V21a.75.75 0 0 1-1.5 0v-8.25H3a.75.75 0 0 1 0-1.5h8.25V3a.75.75 0 0 1 .75-.75Z"
                    clip-rule="evenodd" />
                </svg>
                æ·»åŠ èƒ½åŠ›
              </button>
              <div class="relative">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                  class="w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none">
                  <path fill-rule="evenodd"
                    d="M10.5 3a7.5 7.5 0 0 1 5.96 12.05l4.245 4.245a.75.75 0 1 1-1.06 1.06l-4.245-4.245A7.5 7.5 0 1 1 10.5 3Zm-6 7.5a6 6 0 1 0 12 0 6 6 0 0 0-12 0Z"
                    clip-rule="evenodd" />
                </svg>
                <input id="search-input" type="text" placeholder="æœç´¢èƒ½åŠ›..."
                  class="w-full rounded-xl border border-gray-200 bg-gray-50 text-sm py-2.5 pl-9 pr-3 focus:border-primary focus:ring-primary" />
              </div>
            </div>

            <div id="ability-list" class="flex-1 min-h-0 overflow-y-auto no-scrollbar p-3 space-y-2"></div>

            <!-- ä¾›åº”å•†ç®¡ç†å…¥å£ -->
            <div class="p-3 border-t border-border-light">
              <button id="provider-manage-btn" type="button"
                class="w-full flex items-center gap-2 px-3 py-2.5 rounded-xl text-sm font-medium text-gray-600 hover:bg-gray-100 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                  <path fill-rule="evenodd"
                    d="M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 0 0-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 0 0-2.282.819l-.922 1.597a1.875 1.875 0 0 0 .432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 0 0 0 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 0 0-.432 2.385l.922 1.597a1.875 1.875 0 0 0 2.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 0 0 2.28-.819l.923-1.597a1.875 1.875 0 0 0-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 0 0 0-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 0 0-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 0 0-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 0 0-1.85-1.567h-1.843ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z"
                    clip-rule="evenodd" />
                </svg>
                API ä¾›åº”å•†ç®¡ç†
              </button>
            </div>
          </aside>

          <section class="bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden flex flex-col min-h-0">
            <div id="auth-banner"
              class="hidden mx-5 mt-5 rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800">
              å½“å‰æœªç™»å½•ï¼Œèƒ½åŠ›é…ç½®æ— æ³•ä¿å­˜ã€‚è¯·å…ˆç™»å½• SecondMeã€‚
            </div>

            <form id="ability-form" class="flex-1 min-h-0 overflow-y-auto no-scrollbar" autocomplete="off">
              <div
                class="h-28 md:h-32 bg-gradient-to-r from-orange-400 via-orange-400 to-pink-500 px-6 md:px-8 pt-5 flex items-start justify-between">
                <div>
                  <p class="text-white/90 text-xs font-bold uppercase tracking-wider">èƒ½åŠ›è¯¦æƒ…é…ç½®</p>
                  <h1 id="form-title" class="text-white text-lg md:text-2xl font-black mt-1">æ–°å»ºèƒ½åŠ›</h1>
                </div>
              </div>

              <div class="px-5 md:px-8 pb-8 -mt-6 space-y-6">
                <div
                  class="grid grid-cols-1 md:grid-cols-[92px_minmax(0,1fr)] gap-4 items-center bg-white rounded-2xl border border-gray-100 p-4 shadow-sm">
                  <!-- å°é¢å›¾/Emoji åŒºåŸŸï¼ˆå¯ç‚¹å‡»ä¸Šä¼ ï¼‰ -->
                  <div id="cover-upload-area"
                    class="relative w-[92px] h-[92px] rounded-2xl overflow-hidden cursor-pointer group" title="ç‚¹å‡»ä¸Šä¼ å°é¢å›¾">
                    <!-- æ— å°é¢æ—¶æ˜¾ç¤º emoji -->
                    <div id="avatar-emoji"
                      class="w-full h-full bg-gradient-to-br from-orange-100 to-pink-100 flex items-center justify-center text-4xl">
                      ğŸ¤–</div>
                    <!-- æœ‰å°é¢æ—¶æ˜¾ç¤ºå›¾ç‰‡ -->
                    <div id="cover-preview-wrapper" class="absolute inset-0 hidden">
                      <img id="cover-preview-img" class="w-full h-full object-cover" alt="å°é¢é¢„è§ˆ" />
                      <button id="cover-remove-btn" type="button"
                        class="absolute top-1 right-1 w-5 h-5 rounded-full bg-black/60 text-white flex items-center justify-center text-[10px] opacity-0 group-hover:opacity-100 hover:bg-red-500/80 transition-all"
                        title="ç§»é™¤å°é¢å›¾">&times;</button>
                    </div>
                    <!-- æ‚¬æµ®ä¸Šä¼ æç¤º -->
                    <div
                      class="absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none rounded-2xl">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                        stroke="white" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                          d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z" />
                        <path stroke-linecap="round" stroke-linejoin="round"
                          d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0Z" />
                      </svg>
                    </div>
                    <input id="cover-file-input" type="file" accept="image/*" class="hidden" />
                  </div>
                  <div class="space-y-2 min-w-0">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div>
                        <label class="block text-xs font-bold text-gray-700 uppercase tracking-wider mb-1">AI åç§°</label>
                        <input id="field-name" type="text"
                          class="w-full rounded-xl border-gray-200 bg-gray-50 py-2.5 px-3 text-sm font-bold focus:ring-primary focus:border-primary"
                          placeholder="ä¾‹å¦‚ï¼šè§†è§‰ç¾åŒ–å¤§å¸ˆ" required />
                      </div>
                      <div>
                        <label class="block text-xs font-bold text-gray-700 uppercase tracking-wider mb-1">å›¾æ ‡
                          Emoji</label>
                        <input id="field-icon" type="text"
                          class="w-full rounded-xl border-gray-200 bg-gray-50 py-2.5 px-3 text-sm focus:ring-primary focus:border-primary"
                          placeholder="ğŸ¨" maxlength="2" />
                      </div>
                    </div>
                    <div>
                      <label class="block text-xs font-bold text-gray-700 uppercase tracking-wider mb-1">çŸ­ä»‹ç»</label>
                      <input id="field-description" type="text"
                        class="w-full rounded-xl border-gray-200 bg-gray-50 py-2.5 px-3 text-sm focus:ring-primary focus:border-primary"
                        placeholder="ä¸€å¥è¯è¯´æ˜è¿™ä¸ªèƒ½åŠ›æ“…é•¿åšä»€ä¹ˆ" />
                    </div>
                  </div>
                </div>

                <!-- é£æ ¼ç®¡ç†åŒºåŸŸ -->
                <div>
                  <div class="flex items-center justify-between mb-2">
                    <label class="flex items-center gap-2 text-xs font-bold text-gray-800 uppercase tracking-wider">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-4 h-4 text-primary">
                        <path stroke-linecap="round" stroke-linejoin="round"
                          d="M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42" />
                      </svg>
                      é£æ ¼é€‰é¡¹
                    </label>
                    <span id="style-count"
                      class="text-[11px] font-bold px-2 py-0.5 rounded bg-gray-100 text-gray-500">0</span>
                  </div>
                  <div id="style-list" class="style-scroll">
                    <!-- é£æ ¼å¡ç‰‡ç”± JS åŠ¨æ€æ¸²æŸ“ -->
                  </div>
                </div>

                <div>
                  <label class="flex items-center gap-2 text-xs font-bold text-gray-800 uppercase tracking-wider mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                      stroke="currentColor" class="w-4 h-4 text-primary">
                      <path stroke-linecap="round" stroke-linejoin="round"
                        d="M6.75 7.5h10.5m-10.5 4.5h10.5m-10.5 4.5h10.5M3 4.5h18v15H3v-15Z" />
                    </svg>
                    ç³»ç»Ÿæç¤ºè¯ (System Prompt)
                  </label>
                  <textarea id="field-prompt" rows="6"
                    class="w-full rounded-2xl border border-gray-200 bg-gray-50 font-mono text-sm p-4 focus:ring-primary focus:border-primary"
                    placeholder="ä¾‹å¦‚ï¼šä½ æ˜¯ä¸€ä½ä¸“ä¸šä¿®å›¾å¸ˆ...\nè¾“å‡ºåŒ…å«ï¼šä»»åŠ¡è§£è¯»ã€æœ€ç»ˆæç¤ºè¯ã€å‚æ•°å»ºè®®ã€éªŒæ”¶æ ‡å‡†"></textarea>
                </div>

                <div class="rounded-2xl border border-dashed border-gray-300 bg-gray-50 p-4 md:p-5 space-y-4">
                  <div class="flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                      class="w-5 h-5 text-primary">
                      <path fill-rule="evenodd"
                        d="M2.25 6A3.75 3.75 0 0 1 6 2.25h12A3.75 3.75 0 0 1 21.75 6v12A3.75 3.75 0 0 1 18 21.75H6A3.75 3.75 0 0 1 2.25 18V6Zm4.5.75a.75.75 0 0 0 0 1.5h5.25a.75.75 0 0 0 0-1.5H6.75Zm0 4.5a.75.75 0 0 0 0 1.5h10.5a.75.75 0 0 0 0-1.5H6.75Zm0 4.5a.75.75 0 0 0 0 1.5h7.5a.75.75 0 0 0 0-1.5h-7.5Z"
                        clip-rule="evenodd" />
                    </svg>
                    <h3 class="text-xs font-black tracking-wider uppercase">è‡ªå®šä¹‰ API é…ç½®</h3>
                  </div>

                  <div
                    class="rounded-xl border border-gray-200 bg-white p-3 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                    <div>
                      <p class="text-sm font-bold text-gray-900">ä½¿ç”¨è‡ªå®šä¹‰ API</p>
                      <p id="api-mode-hint" class="text-xs text-gray-600 mt-0.5">
                        å…³é—­æ—¶ä½¿ç”¨ SecondMe AI æ¥å£ï¼›å¼€å¯åå°†ä½¿ç”¨ä¸‹æ–¹è‡ªå®šä¹‰ API ä¸æ¨¡å‹ã€‚
                      </p>
                    </div>
                    <input id="field-use-custom-api" type="checkbox" class="switch" />
                  </div>

                  <div id="custom-api-panel" class="space-y-3">
                    <!-- ä¾›åº”å•†é€‰æ‹© -->
                    <div>
                      <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">é€‰æ‹©ä¾›åº”å•†</label>
                      <div class="flex gap-2">
                        <select id="field-provider-select"
                          class="flex-1 rounded-lg border-gray-200 bg-white py-2.5 px-3 text-sm focus:ring-primary focus:border-primary">
                          <option value="">-- æ‰‹åŠ¨å¡«å†™ --</option>
                        </select>
                        <button id="add-provider-quick-btn" type="button"
                          class="px-3 py-2 rounded-lg border border-gray-300 bg-white text-sm font-bold text-gray-700 hover:border-primary hover:text-primary transition-colors whitespace-nowrap">
                          + æ–°å»º
                        </button>
                      </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div>
                        <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">API Endpoint</label>
                        <input id="field-api-endpoint" type="url" placeholder="https://api.example.com/v1"
                          class="w-full rounded-lg border-gray-200 bg-white py-2.5 px-3 text-sm focus:ring-primary focus:border-primary" />
                      </div>
                      <div>
                        <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">API Key</label>
                        <input id="field-api-key" type="password" placeholder="sk-..."
                          class="w-full rounded-lg border-gray-200 bg-white py-2.5 px-3 text-sm focus:ring-primary focus:border-primary" />
                      </div>
                    </div>

                    <!-- èƒ½åŠ›ç±»å‹é€‰æ‹© -->
                    <div class="rounded-xl border border-gray-200 bg-white p-3 space-y-3">
                      <label class="block text-[11px] font-bold text-gray-600 uppercase">èƒ½åŠ›ç±»å‹</label>
                      <div class="flex gap-3">
                        <label
                          class="flex items-center gap-2 cursor-pointer px-4 py-2.5 rounded-xl border-2 transition-all text-sm font-bold"
                          id="ability-type-text-label">
                          <input type="radio" name="ability-type" id="field-ability-type-text" value="text" checked
                            class="text-primary focus:ring-primary" />
                          <span>ğŸ“ æ–‡æœ¬ç”Ÿæˆ</span>
                        </label>
                        <label
                          class="flex items-center gap-2 cursor-pointer px-4 py-2.5 rounded-xl border-2 transition-all text-sm font-bold"
                          id="ability-type-image-label">
                          <input type="radio" name="ability-type" id="field-ability-type-image" value="image"
                            class="text-primary focus:ring-primary" />
                          <span>ğŸ¨ å›¾åƒç”Ÿæˆ</span>
                        </label>
                      </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-[minmax(0,1fr)_auto] gap-3 items-end">
                      <div>
                        <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">æ¨¡å‹</label>
                        <select id="field-api-model"
                          class="w-full rounded-lg border-gray-200 bg-white py-2.5 px-3 text-sm focus:ring-primary focus:border-primary"></select>
                      </div>
                      <button id="fetch-models-btn" type="button"
                        class="h-10 px-4 rounded-lg border border-gray-300 bg-white text-sm font-bold text-gray-700 hover:border-primary hover:text-primary transition-colors">
                        Fetch æ¨¡å‹
                      </button>
                    </div>

                    <!-- å›¾åƒç”Ÿæˆä¸“å±é…ç½® -->
                    <div id="image-config-panel"
                      class="hidden rounded-xl border border-blue-200 bg-blue-50/50 p-4 space-y-3">
                      <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                          stroke="currentColor" class="w-4 h-4 text-blue-600">
                          <path stroke-linecap="round" stroke-linejoin="round"
                            d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909M3.75 21h16.5A2.25 2.25 0 0 0 22.5 18.75V5.25A2.25 2.25 0 0 0 20.25 3H3.75A2.25 2.25 0 0 0 1.5 5.25v13.5A2.25 2.25 0 0 0 3.75 21Z" />
                        </svg>
                        <span class="text-xs font-bold text-blue-800 uppercase">å›¾åƒç”Ÿæˆé…ç½®</span>
                      </div>
                      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div>
                          <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">å›¾ç‰‡å°ºå¯¸</label>
                          <select id="field-image-size"
                            class="w-full rounded-lg border-gray-200 bg-white py-2.5 px-3 text-sm focus:ring-primary focus:border-primary">
                            <option value="1024x1024">1024 Ã— 1024ï¼ˆæ­£æ–¹å½¢ï¼‰</option>
                            <option value="1024x1792">1024 Ã— 1792ï¼ˆç«–ç‰ˆï¼‰</option>
                            <option value="1792x1024">1792 Ã— 1024ï¼ˆæ¨ªç‰ˆï¼‰</option>
                            <option value="512x512">512 Ã— 512ï¼ˆå°å°ºå¯¸ï¼‰</option>
                            <option value="256x256">256 Ã— 256ï¼ˆç¼©ç•¥å›¾ï¼‰</option>
                          </select>
                        </div>
                        <div>
                          <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">å›¾ç‰‡è´¨é‡</label>
                          <select id="field-image-quality"
                            class="w-full rounded-lg border-gray-200 bg-white py-2.5 px-3 text-sm focus:ring-primary focus:border-primary">
                            <option value="standard">æ ‡å‡† (Standard)</option>
                            <option value="hd">é«˜æ¸… (HD)</option>
                          </select>
                        </div>
                      </div>
                      <div>
                        <button id="test-image-btn" type="button"
                          class="inline-flex items-center gap-2 px-4 py-2.5 rounded-xl border border-blue-300 bg-white text-sm font-bold text-blue-700 hover:bg-blue-100 hover:border-blue-400 transition-colors">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-4 h-4">
                            <path stroke-linecap="round" stroke-linejoin="round"
                              d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z" />
                          </svg>
                          æµ‹è¯•å›¾åƒç”Ÿæˆ
                        </button>
                        <p id="test-image-status" class="text-xs text-gray-500 mt-2">ç‚¹å‡»æŒ‰é’®æµ‹è¯•å½“å‰ API æ˜¯å¦æ”¯æŒå›¾åƒç”Ÿæˆã€‚</p>
                        <div id="test-image-preview" class="mt-3 hidden">
                          <img class="w-48 h-48 object-cover rounded-xl border border-gray-200 shadow-sm" />
                        </div>
                      </div>
                    </div>

                    <p id="fetch-status" class="text-xs text-gray-500">ç‚¹å‡» â€œFetch æ¨¡å‹â€ è·å–å½“å‰ API å¯ç”¨æ¨¡å‹ã€‚</p>
                  </div>
                </div>

                <div class="flex flex-wrap items-center justify-between gap-3 pt-2">
                  <button id="delete-btn" type="button"
                    class="px-4 py-2 rounded-xl text-sm font-bold text-red-600 hover:bg-red-50 transition-colors hidden">
                    åˆ é™¤èƒ½åŠ›
                  </button>
                  <div class="ml-auto flex items-center gap-2">
                    <button id="reset-btn" type="button"
                      class="px-5 py-2 rounded-xl text-sm font-bold text-gray-600 hover:bg-gray-100 transition-colors">
                      é‡ç½®
                    </button>
                    <button id="save-btn" type="submit"
                      class="px-7 py-2 rounded-xl text-sm font-bold text-white bg-black hover:bg-gray-800 transition-colors">
                      ä¿å­˜æ›´æ”¹
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </section>
        </div>
      </div>
    </main>
  </div>

  <!-- ä¾›åº”å•†ç®¡ç†å¼¹çª— -->
  <div id="provider-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/40 backdrop-blur-sm" id="provider-modal-backdrop"></div>
    <div
      class="absolute inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-2xl md:max-h-[80vh] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden">
      <div class="px-5 py-4 border-b border-gray-100 flex items-center justify-between">
        <h2 class="text-lg font-black">API ä¾›åº”å•†ç®¡ç†</h2>
        <button id="provider-modal-close" type="button" class="p-1.5 rounded-lg hover:bg-gray-100 transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 text-gray-500">
            <path fill-rule="evenodd"
              d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z"
              clip-rule="evenodd" />
          </svg>
        </button>
      </div>
      <div class="flex-1 overflow-y-auto p-5">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- ä¾›åº”å•†åˆ—è¡¨ -->
          <div class="space-y-3">
            <div class="flex items-center justify-between">
              <h3 class="text-sm font-bold text-gray-700">å·²ä¿å­˜çš„ä¾›åº”å•†</h3>
              <button id="add-provider-btn" type="button" class="text-xs font-bold text-primary hover:underline">+
                æ·»åŠ </button>
            </div>
            <div id="provider-list" class="space-y-2 max-h-[300px] overflow-y-auto">
              <p class="text-sm text-gray-400 text-center py-6">æš‚æ— ä¾›åº”å•†ï¼Œç‚¹å‡»ã€Œæ·»åŠ ã€åˆ›å»º</p>
            </div>
          </div>
          <!-- ä¾›åº”å•†ç¼–è¾‘è¡¨å• -->
          <div id="provider-form-panel" class="hidden">
            <h3 class="text-sm font-bold text-gray-700 mb-3" id="provider-form-title">æ–°å»ºä¾›åº”å•†</h3>
            <div class="space-y-3">
              <div>
                <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">ä¾›åº”å•†åç§°</label>
                <input id="provider-name" type="text" placeholder="ä¾‹å¦‚ï¼šOpenAIã€é˜¿é‡Œäº‘é€šä¹‰"
                  class="w-full rounded-lg border-gray-200 bg-gray-50 py-2.5 px-3 text-sm focus:ring-primary focus:border-primary" />
              </div>
              <div>
                <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">API Endpoint</label>
                <input id="provider-endpoint" type="url" placeholder="https://api.example.com/v1"
                  class="w-full rounded-lg border-gray-200 bg-gray-50 py-2.5 px-3 text-sm focus:ring-primary focus:border-primary" />
              </div>
              <div>
                <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">API Key</label>
                <input id="provider-apikey" type="password" placeholder="sk-..."
                  class="w-full rounded-lg border-gray-200 bg-gray-50 py-2.5 px-3 text-sm focus:ring-primary focus:border-primary" />
              </div>
              <div class="flex items-center gap-2 pt-2">
                <button id="provider-save-btn" type="button"
                  class="flex-1 py-2.5 rounded-xl text-sm font-bold text-white bg-black hover:bg-gray-800 transition-colors">ä¿å­˜ä¾›åº”å•†</button>
                <button id="provider-cancel-btn" type="button"
                  class="px-4 py-2.5 rounded-xl text-sm font-bold text-gray-600 hover:bg-gray-100 transition-colors">å–æ¶ˆ</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- é£æ ¼ç¼–è¾‘å¼¹çª— -->
  <div id="style-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/40 backdrop-blur-sm" id="style-modal-backdrop"></div>
    <div
      class="absolute inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-md bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden">
      <div class="px-5 py-4 border-b border-gray-100 flex items-center justify-between">
        <h2 id="style-modal-title" class="text-lg font-black">æ·»åŠ é£æ ¼</h2>
        <button id="style-modal-close" type="button" class="p-1.5 rounded-lg hover:bg-gray-100 transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 text-gray-500">
            <path fill-rule="evenodd"
              d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z"
              clip-rule="evenodd" />
          </svg>
        </button>
      </div>
      <div class="p-5 space-y-4">
        <div>
          <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">é£æ ¼åç§°</label>
          <input id="style-field-name" type="text" placeholder="ä¾‹å¦‚ï¼šèµ›åšæœ‹å…‹"
            class="w-full rounded-lg border-gray-200 bg-gray-50 py-2.5 px-3 text-sm focus:ring-primary focus:border-primary" />
        </div>
        <div>
          <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">é£æ ¼å›¾ç‰‡</label>
          <!-- ä¸Šä¼ åŒºåŸŸ -->
          <div id="style-upload-area"
            class="relative w-full h-32 rounded-xl border-2 border-dashed border-gray-300 bg-gray-50 flex flex-col items-center justify-center gap-1 cursor-pointer hover:border-primary hover:bg-orange-50/50 transition-all mb-2"
            title="ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor" class="w-6 h-6 text-gray-400">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
            </svg>
            <span class="text-xs font-medium text-gray-500">ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡</span>
            <span class="text-[10px] text-gray-400">æ”¯æŒ JPG / PNG / WebP / GIFï¼Œæœ€å¤§ 5MB</span>
            <input id="style-file-input" type="file" accept="image/jpeg,image/png,image/webp,image/gif"
              class="absolute inset-0 opacity-0 cursor-pointer" />
          </div>
          <!-- ä¸Šä¼ çŠ¶æ€ -->
          <p id="style-upload-status" class="text-xs text-gray-500 mb-2 hidden"></p>
          <!-- å›¾ç‰‡é¢„è§ˆ -->
          <div id="style-image-preview" class="relative mt-1 hidden">
            <img class="w-full h-32 object-cover rounded-lg border border-gray-200" />
            <button id="style-image-clear" type="button"
              class="absolute top-1.5 right-1.5 w-6 h-6 rounded-full bg-black/50 text-white flex items-center justify-center text-xs hover:bg-black/70 transition-colors"
              title="ç§»é™¤å›¾ç‰‡">&times;</button>
          </div>
          <!-- éšè—å­—æ®µå­˜å‚¨å›¾ç‰‡ URL -->
          <input id="style-field-image" type="hidden" />
        </div>
        <div>
          <label class="block text-[11px] font-bold text-gray-600 uppercase mb-1">é£æ ¼æç¤ºè¯</label>
          <textarea id="style-field-prompt" rows="4"
            class="w-full rounded-lg border-gray-200 bg-gray-50 font-mono text-sm p-3 focus:ring-primary focus:border-primary"
            placeholder="è¿™ä¸ªé£æ ¼è¦ä½¿ç”¨çš„ç‰¹å®šæç¤ºè¯..."></textarea>
        </div>
        <div class="flex items-center gap-2 pt-1">
          <button id="style-save-btn" type="button"
            class="flex-1 py-2.5 rounded-xl text-sm font-bold text-white bg-black hover:bg-gray-800 transition-colors">ä¿å­˜é£æ ¼</button>
          <button id="style-cancel-btn" type="button"
            class="px-4 py-2.5 rounded-xl text-sm font-bold text-gray-600 hover:bg-gray-100 transition-colors">å–æ¶ˆ</button>
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"></div>
  <script src="/capability.js"></script>
</body>

</html>